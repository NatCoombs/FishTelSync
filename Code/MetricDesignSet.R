# Make a design subset by pulling the ones I like from prior sets

DesignSet<-data.frame()

DesignSet[1,c(1,2)]<-c("STH0460", "STH0062")
DesignSet[2,c(1,2)]<-c("STH0245", "STH0032")
DesignSet[3,c(1,2)]<-c("STH0053", "STH0048")
DesignSet[4,c(1,2)]<-c("STH0464", "STH0452")
DesignSet[5,c(1,2)]<-c("STH0063", "STH0024")
DesignSet[6,c(1,2)]<-c("STH0021", "STH0005")
DesignSet[7,c(1,2)]<-c("STH0100", "STH0092")
DesignSet[8,c(1,2)]<-c("STH0098", "STH0048")
DesignSet[9,c(1,2)]<-c("STH0023", "STH0145")
DesignSet[10,c(1,2)]<-c("STH0016", "STH0151")
DesignSet[11,c(1,2)]<-c("STH0021", "STH0001")
DesignSet[12,c(1,2)]<-c("STH0469", "STH0151")
DesignSet[13,c(1,2)]<-c("STH0455", "STH0429")
DesignSet[14,c(1,2)]<-c("STH0028", "STH0018")
DesignSet[15,c(1,2)]<-c("STH0052", "STH0021")
DesignSet[16,c(1,2)]<-c("STH0442", "STH0158")
DesignSet[17,c(1,2)]<-c("STH0142", "STH0079")
DesignSet[18,c(1,2)]<-c("STH0079", "STH0052")
DesignSet[19,c(1,2)]<-c("STH0079", "STH0425")
DesignSet[20,c(1,2)]<-c("STH0442", "STH0417")
DesignSet[21,c(1,2)]<-c("STH0455", "STH0446")
DesignSet[22,c(1,2)]<-c("STH0450", "STH0452")
DesignSet[23,c(1,2)]<-c("STH0450", "STH0254")

DesignSet[24,c(1,2)]<-c("STH0150", "STH0005")
DesignSet[25,c(1,2)]<-c("STH0466", "STH0429")
DesignSet[26,c(1,2)]<-c("STH0142", "STH0119")
DesignSet[27,c(1,2)]<-c("STH0079", "STH0021")
DesignSet[28,c(1,2)]<-c("STH0119", "STH0010")
DesignSet[29,c(1,2)]<-c("STH0467", "STH0151")
DesignSet[30,c(1,2)]<-c("STH0446", "STH0128")
DesignSet[31,c(1,2)]<-c("STH0170", "STH0119")
DesignSet[32,c(1,2)]<-c("STH0427", "STH0457")
DesignSet[33,c(1,2)]<-c("STH0036", "STH0425")
DesignSet[34,c(1,2)]<-c("STH0024", "STH0010")
DesignSet[35,c(1,2)]<-c("STH0145", "STH0081")
DesignSet[36,c(1,2)]<-c("STH0119", "STH0010")
DesignSet[37,c(1,2)]<-c("STH0460", "STH0063")
DesignSet[38,c(1,2)]<-c("STH0091", "STH0036")
DesignSet[39,c(1,2)]<-c("STH0079", "STH0001")
DesignSet[40,c(1,2)]<-c("STH0079", "STH0001")

DesignSet[41,c(1,2)]<-c("STH0023", "STH0032")
DesignSet[42,c(1,2)]<-c("STH0024", "STH0021")
DesignSet[43,c(1,2)]<-c("STH0063", "STH0429")
DesignSet[44,c(1,2)]<-c("STH0136", "STH0010")
DesignSet[45,c(1,2)]<-c("STH0053", "STH0024")
DesignSet[46,c(1,2)]<-c("STH0021", "STH0026")
DesignSet[47,c(1,2)]<-c("STH0442", "STH0464")
DesignSet[48,c(1,2)]<-c("STH0275", "STH0420")
DesignSet[49,c(1,2)]<-c("STH0094", "STH0024")
DesignSet[50,c(1,2)]<-c("STH0150", "STH0136")
DesignSet[51,c(1,2)]<-c("STH0467", "STH0128")
DesignSet[52,c(1,2)]<-c("STH0464", "STH0461")
DesignSet[53,c(1,2)]<-c("STH0023", "STH0425")
DesignSet[54,c(1,2)]<-c("STH0016", "STH0460")
DesignSet[55,c(1,2)]<-c("STH0197", "STH0063")
DesignSet[56,c(1,2)]<-c("STH0197", "STH0063")

xlimsDesign<-data.frame()
xlimsDesign[1,c(1,2)]<-c(13600,13665)
xlimsDesign[2,c(1,2)]<-c(13560,13650)
xlimsDesign[3,c(1,2)]<-c(13530,13570)
xlimsDesign[4,c(1,2)]<-c(13600,13625)
xlimsDesign[5,c(1,2)]<-c(13545,13600)
xlimsDesign[6,c(1,2)]<-c(13530,13570)
xlimsDesign[7,c(1,2)]<-c(13535,13560)
xlimsDesign[8,c(1,2)]<-c(13540,13570)
xlimsDesign[9,c(1,2)]<-c(13550,13565)
xlimsDesign[10,c(1,2)]<-c(13620,13670)
xlimsDesign[11,c(1,2)]<-c(13520,13560)
xlimsDesign[12,c(1,2)]<-c(13580,13660)
xlimsDesign[13,c(1,2)]<-c(13600,13700)
xlimsDesign[14,c(1,2)]<-c(13525,13575)
xlimsDesign[15,c(1,2)]<-c(13530,13575)
xlimsDesign[16,c(1,2)]<-c(13620,13650)
xlimsDesign[17,c(1,2)]<-c(13545,13570)
xlimsDesign[18,c(1,2)]<-c(13530,13570)
xlimsDesign[19,c(1,2)]<-c(13535,13570)
xlimsDesign[20,c(1,2)]<-c(13625,13800)
xlimsDesign[21,c(1,2)]<-c(13625,13640)
xlimsDesign[22,c(1,2)]<-c(13617,13630)
xlimsDesign[23,c(1,2)]<-c(13615,13630)
xlimsDesign[24,c(1,2)]<-c(13545,13570)
xlimsDesign[25,c(1,2)]<-c(13600,13650)
xlimsDesign[26,c(1,2)]<-c(13545,13575)
xlimsDesign[27,c(1,2)]<-c(13535,13570)
xlimsDesign[28,c(1,2)]<-c(13540,13565)
xlimsDesign[29,c(1,2)]<-c(13600,13800)
xlimsDesign[30,c(1,2)]<-c(13610,13640)
xlimsDesign[31,c(1,2)]<-c(13545,13560)
xlimsDesign[32,c(1,2)]<-c(13640,13690)
xlimsDesign[33,c(1,2)]<-c(13525,13565)
xlimsDesign[34,c(1,2)]<-c(13530,13575)
xlimsDesign[35,c(1,2)]<-c(13543,13560)
xlimsDesign[36,c(1,2)]<-c(13540,13565)
xlimsDesign[37,c(1,2)]<-c(13600,13650)
xlimsDesign[38,c(1,2)]<-c(13553,13565)
xlimsDesign[39,c(1,2)]<-c(13535,13560)
xlimsDesign[40,c(1,2)]<-c(13535,13560)
xlimsDesign[41,c(1,2)]<-c(13550,13580)
xlimsDesign[42,c(1,2)]<-c(13530,13570)
xlimsDesign[43,c(1,2)]<-c(13525,13650)
xlimsDesign[44,c(1,2)]<-c(13540,13565)
xlimsDesign[45,c(1,2)]<-c(13530,13570)
xlimsDesign[46,c(1,2)]<-c(13530,13560)
xlimsDesign[47,c(1,2)]<-c(13600,13800)
xlimsDesign[48,c(1,2)]<-c(13575,13625)
xlimsDesign[49,c(1,2)]<-c(13540,13570)
xlimsDesign[50,c(1,2)]<-c(13550,13565)
xlimsDesign[51,c(1,2)]<-c(13600,13650)
xlimsDesign[52,c(1,2)]<-c(13600,13625)
xlimsDesign[53,c(1,2)]<-c(13555,13570)
xlimsDesign[54,c(1,2)]<-c(13625,13650)
xlimsDesign[55,c(1,2)]<-c(13550,13650)
xlimsDesign[56,c(1,2)]<-c(13550,13650)

PlotSet<-DesignSet
pdf(file = "/Users/nathanielcoombs/Documents/Git/Repos/FishTelPrac/Results/SampledPairwiseFishMovements.pdf")
par(mfrow = c(2,2))
for(i in 1:length(PlotSet[,1])){
  f1<-PlotSet[i,1]
  f2<-PlotSet[i,2]
  # MapLims<-RangeCompareXY(f1 = f1, f2 = f2, RelFrame = AllSteelDense, 
  #                         xCol = "Lon", yCol = "Lat", fCol = "FishID")
  # tLims<-RangeCompareT(f1 = f1, f2 = f2, RelFrame = AllSteelDense, 
  # tCol = "Times", fCol = "FishID")
  # plot.new()
  wfplot(WaterFrame = AllSteelFall,FishCol = "Fish",tCol = "ChronTimes",
         RkmCol = "Rkm",FishIDs = c(f1,f2))
  wfplot(WaterFrame = AllSteelFall,FishCol = "Fish",tCol = "ChronTimes",
         RkmCol = "Rkm",FishIDs = f2)
  FishDetMap(AllSteelDense,IDCol = "FishID", LatCol = "Lat", LonCol = "Lon", WaterMaps = CAHydroLL, 
             FishID = f1, LandMaps = CALandLL, textlab = TRUE, MonoCol = "Red", RkmCol = "Rkm",
             nonNew = TRUE)
  FishDetMap(AllSteelDense,IDCol = "FishID", LatCol = "Lat", LonCol = "Lon", WaterMaps = CAHydroLL, 
             FishID = f2, LandMaps = CALandLL, textlab = TRUE, MonoCol = "Red", RkmCol = "Rkm",
             nonNew = TRUE)
}

dev.off()


PlotSet<-DesignSet
pdf(file = "/Users/nathanielcoombs/Documents/Git/Repos/FishTelPrac/Results/DesignSetPWFM.pdf")
for(i in 1:length(PlotSet[,1])){
  f1<-PlotSet[i,1]
  f2<-PlotSet[i,2]
  
  par(mfrow = c(2,2))
  
  plot(x = AllSteelFall[which(AllSteelFall$Fish == f1), "ChronTimes"],
       y = AllSteelFall[which(AllSteelFall$Fish == f1), "Rkm"],
       type = "l", xlab = "Date", ylab = "Rkm",
       main = paste("Waterfall plot for", f1, sep = " "))

  plot(x = AllSteelFall[which(AllSteelFall$Fish == f2), "ChronTimes"],
       y = AllSteelFall[which(AllSteelFall$Fish == f2), "Rkm"],
       type = "l", xlab = "Date", ylab = "Rkm",
       main = paste("Waterfall plot for", f2, sep = " "))

  FishDetMap(AllSteelDense,IDCol = "FishID", LatCol = "Lat", LonCol = "Lon", WaterMaps = CAHydroLL, 
             FishID = f1, LandMaps = CALandLL, textlab = TRUE, MonoCol = "Red", RkmCol = "Rkm",
             nonNew = TRUE)
  FishDetMap(AllSteelDense,IDCol = "FishID", LatCol = "Lat", LonCol = "Lon", WaterMaps = CAHydroLL, 
             FishID = f2, LandMaps = CALandLL, textlab = TRUE, MonoCol = "Red", RkmCol = "Rkm",
             nonNew = TRUE)

  par(mfrow = c(1,1))
  plot(x = AllSteelFall[which(AllSteelFall$Fish == f1), "ChronTimes"],
       y = AllSteelFall[which(AllSteelFall$Fish == f1), "Rkm"], ylim = c(0, 525),
       type = "l", xlab = "Date", ylab = "Rkm", col = "Red", xlim = c(xlimsDesign[i,1],xlimsDesign[i,2]),
       main = paste("Waterfall plot for", f1, f2, sep = " "))
  lines(x = AllSteelFall[which(AllSteelFall$Fish == f2), "ChronTimes"],
        y = AllSteelFall[which(AllSteelFall$Fish == f2), "Rkm"], col = "Blue")

}

dev.off()


PlotSet<-DesignSet
pdf(file = "/Users/nathanielcoombs/Documents/Git/Repos/FishTelPrac/Results/SingleRelease.pdf")
for(i in 1:length(PlotSet[,1])){
  f1<-PlotSet[i,1]
  f2<-PlotSet[i,2]
  
  par(mfrow = c(2,2))
  
  plot(x = AllSteelFall[which(AllSteelFall$Fish == f1), "ChronTimes"],
       y = AllSteelFall[which(AllSteelFall$Fish == f1), "Rkm"],
       type = "l", xlab = "Date", ylab = "Rkm",
       main = paste("Waterfall plot for", f1, sep = " "))
  
  plot(x = AllSteelFall[which(AllSteelFall$Fish == f2), "ChronTimes"],
       y = AllSteelFall[which(AllSteelFall$Fish == f2), "Rkm"],
       type = "l", xlab = "Date", ylab = "Rkm",
       main = paste("Waterfall plot for", f2, sep = " "))
  
  FishDetMap(AllSteelDense,IDCol = "FishID", LatCol = "Lat", LonCol = "Lon", WaterMaps = CAHydroLL, 
             FishID = f1, LandMaps = CALandLL, textlab = TRUE, MonoCol = "Red", RkmCol = "Rkm",
             nonNew = TRUE)
  FishDetMap(AllSteelDense,IDCol = "FishID", LatCol = "Lat", LonCol = "Lon", WaterMaps = CAHydroLL, 
             FishID = f2, LandMaps = CALandLL, textlab = TRUE, MonoCol = "Red", RkmCol = "Rkm",
             nonNew = TRUE)
  
  par(mfrow = c(1,1))
  plot(x = AllSteelFall[which(AllSteelFall$Fish == f1), "ChronTimes"],
       y = AllSteelFall[which(AllSteelFall$Fish == f1), "Rkm"], ylim = c(0, 525),
       type = "l", xlab = "Date", ylab = "Rkm", col = "Red", xlim = c(xlimsDesign[i,1],xlimsDesign[i,2]),
       main = paste("Waterfall plot for", f1, f2, sep = " "))
  lines(x = AllSteelFall[which(AllSteelFall$Fish == f2), "ChronTimes"],
        y = AllSteelFall[which(AllSteelFall$Fish == f2), "Rkm"], col = "Blue")
  
}

dev.off()

FWSSteelFall$ChronTimes<-as.chron(FWSSteelFall$Times)

FWSSteelFall<-na.omit(FWSSteelFall)
SHK200FWSDense<-na.omit(SHK200FWSDense)

PlotSet<-Pairs05
pdf(file = "/Users/nathanielcoombs/Documents/Git/Repos/FishTelPrac/Results/SingleRelease05.pdf")
for(i in 1:length(PlotSet[,1])){
  f1<-PlotSet[i,1]
  f2<-PlotSet[i,2]
  
  par(mfrow = c(2,2))
  
  plot(x = FWSSteelFall[which(FWSSteelFall$Fish == f1), "ChronTimes"],
       y = FWSSteelFall[which(FWSSteelFall$Fish == f1), "Rkm"],
       type = "l", xlab = "Date", ylab = "Rkm",
       main = paste("Waterfall plot for", f1, sep = " "))
  
  plot(x = FWSSteelFall[which(FWSSteelFall$Fish == f2), "ChronTimes"],
       y = FWSSteelFall[which(FWSSteelFall$Fish == f2), "Rkm"],
       type = "l", xlab = "Date", ylab = "Rkm",
       main = paste("Waterfall plot for", f2, sep = " "))
  
  FishDetMap(SHK200FWSDense,IDCol = "FishID", LatCol = "Lat", LonCol = "Lon", WaterMaps = CAHydroLL, 
             FishID = f1, LandMaps = CALandLL, textlab = TRUE, MonoCol = "Red", RkmCol = "Rkm",
             nonNew = TRUE)
  FishDetMap(SHK200FWSDense,IDCol = "FishID", LatCol = "Lat", LonCol = "Lon", WaterMaps = CAHydroLL, 
             FishID = f2, LandMaps = CALandLL, textlab = TRUE, MonoCol = "Red", RkmCol = "Rkm",
             nonNew = TRUE)
  
  # par(mfrow = c(1,1))
  # plot(x = FWSSteelFall[which(FWSSteelFall$Fish == f1), "ChronTimes"],
  #      y = FWSSteelFall[which(FWSSteelFall$Fish == f1), "Rkm"], ylim = c(0, 525),
  #      type = "l", xlab = "Date", ylab = "Rkm", col = "Red", xlim = c(xlimsDesign[i,1],xlimsDesign[i,2]),
  #      main = paste("Waterfall plot for", f1, f2, sep = " "))
  # points(x = FWSSteelFall[which(FWSSteelFall$Fish == f1), "ChronTimes"],
  #        y = FWSSteelFall[which(FWSSteelFall$Fish == f1), "Rkm"], col = "Red")
  # lines(x = FWSSteelFall[which(FWSSteelFall$Fish == f2), "ChronTimes"],
  #       y = FWSSteelFall[which(FWSSteelFall$Fish == f2), "Rkm"], col = "Blue")
  # points(x = FWSSteelFall[which(FWSSteelFall$Fish == f2), "ChronTimes"],
  #       y = FWSSteelFall[which(FWSSteelFall$Fish == f2), "Rkm"], col = "Blue")
}

dev.off()

PlotSet<-Pairs06
pdf(file = "/Users/nathanielcoombs/Documents/Git/Repos/FishTelPrac/Results/SingleRelease06.pdf")
for(i in 1:length(PlotSet[,1])){
  f1<-PlotSet[i,1]
  f2<-PlotSet[i,2]
  
  par(mfrow = c(2,2))
  
  plot(x = FWSSteelFall[which(FWSSteelFall$Fish == f1), "ChronTimes"],
       y = FWSSteelFall[which(FWSSteelFall$Fish == f1), "Rkm"],
       type = "l", xlab = "Date", ylab = "Rkm",
       main = paste("Waterfall plot for", f1, sep = " "))
  
  plot(x = FWSSteelFall[which(FWSSteelFall$Fish == f2), "ChronTimes"],
       y = FWSSteelFall[which(FWSSteelFall$Fish == f2), "Rkm"],
       type = "l", xlab = "Date", ylab = "Rkm",
       main = paste("Waterfall plot for", f2, sep = " "))
  
  FishDetMap(SHK200FWSDense,IDCol = "FishID", LatCol = "Lat", LonCol = "Lon", WaterMaps = CAHydroLL, 
             FishID = f1, LandMaps = CALandLL, textlab = TRUE, MonoCol = "Red", RkmCol = "Rkm",
             nonNew = TRUE)
  FishDetMap(SHK200FWSDense,IDCol = "FishID", LatCol = "Lat", LonCol = "Lon", WaterMaps = CAHydroLL, 
             FishID = f2, LandMaps = CALandLL, textlab = TRUE, MonoCol = "Red", RkmCol = "Rkm",
             nonNew = TRUE)
  
  # par(mfrow = c(1,1))
  # plot(x = FWSSteelFall[which(FWSSteelFall$Fish == f1), "ChronTimes"],
  #      y = FWSSteelFall[which(FWSSteelFall$Fish == f1), "Rkm"], ylim = c(0, 525),
  #      type = "l", xlab = "Date", ylab = "Rkm", col = "Red", xlim = c(xlimsDesign[i,1],xlimsDesign[i,2]),
  #      main = paste("Waterfall plot for", f1, f2, sep = " "))
  # points(x = FWSSteelFall[which(FWSSteelFall$Fish == f1), "ChronTimes"],
  #        y = FWSSteelFall[which(FWSSteelFall$Fish == f1), "Rkm"], col = "Red")
  # lines(x = FWSSteelFall[which(FWSSteelFall$Fish == f2), "ChronTimes"],
  #       y = FWSSteelFall[which(FWSSteelFall$Fish == f2), "Rkm"], col = "Blue")
  # points(x = FWSSteelFall[which(FWSSteelFall$Fish == f2), "ChronTimes"],
  #       y = FWSSteelFall[which(FWSSteelFall$Fish == f2), "Rkm"], col = "Blue")
}

dev.off()

PlotSet<-Pairs07
pdf(file = "/Users/nathanielcoombs/Documents/Git/Repos/FishTelPrac/Results/SingleRelease07.pdf")
for(i in 1:length(PlotSet[,1])){
  f1<-PlotSet[i,1]
  f2<-PlotSet[i,2]
  
  par(mfrow = c(2,2))
  
  wfplot(WaterFrame = AllSteelFall,FishCol = "Fish",tCol = "ChronTimes",
         RkmCol = "Rkm",FishIDs = c(f1,f2))
  # plot(x = FWSSteelFall[which(FWSSteelFall$Fish == f1), "ChronTimes"],
  #      y = FWSSteelFall[which(FWSSteelFall$Fish == f1), "Rkm"],
  #      type = "l", xlab = "Date", ylab = "Rkm",
  #      main = paste("Waterfall plot for", f1, sep = " "))
  # points(x = FWSSteelFall[which(FWSSteelFall$Fish == f1), "ChronTimes"],
  #        y = FWSSteelFall[which(FWSSteelFall$Fish == f1), "Rkm"],)
  plot(x = FWSSteelFall[which(FWSSteelFall$Fish == f2), "ChronTimes"],
       y = FWSSteelFall[which(FWSSteelFall$Fish == f2), "Rkm"],
       type = "l", xlab = "Date", ylab = "Rkm",
       main = paste("Waterfall plot for", f2, sep = " "))
  points(x = FWSSteelFall[which(FWSSteelFall$Fish == f2), "ChronTimes"],
         y = FWSSteelFall[which(FWSSteelFall$Fish == f2), "Rkm"],)
  FishDetMap(SHK200FWSDense,IDCol = "FishID", LatCol = "Lat", LonCol = "Lon", WaterMaps = CAHydroLL, 
             FishID = f1, LandMaps = CALandLL, textlab = TRUE, MonoCol = "Red", RkmCol = "Rkm",
             nonNew = TRUE)
  FishDetMap(SHK200FWSDense,IDCol = "FishID", LatCol = "Lat", LonCol = "Lon", WaterMaps = CAHydroLL, 
             FishID = f2, LandMaps = CALandLL, textlab = TRUE, MonoCol = "Red", RkmCol = "Rkm",
             nonNew = TRUE)
  
  # par(mfrow = c(1,1))
  # 
  # plot(x = FWSSteelFall[which(FWSSteelFall$Fish == f1), "ChronTimes"],
  #      y = FWSSteelFall[which(FWSSteelFall$Fish == f1), "Rkm"], ylim = c(0, 525),
  #      type = "l", xlab = "Date", ylab = "Rkm", col = "Red", 
  #      main = paste("Waterfall plot for", f1, f2, sep = " "))
  # points(x = FWSSteelFall[which(FWSSteelFall$Fish == f1), "ChronTimes"],
  #        y = FWSSteelFall[which(FWSSteelFall$Fish == f1), "Rkm"], col = "Red")
  # lines(x = FWSSteelFall[which(FWSSteelFall$Fish == f2), "ChronTimes"],
  #       y = FWSSteelFall[which(FWSSteelFall$Fish == f2), "Rkm"], col = "Blue")
  # points(x = FWSSteelFall[which(FWSSteelFall$Fish == f2), "ChronTimes"],
  #       y = FWSSteelFall[which(FWSSteelFall$Fish == f2), "Rkm"], col = "Blue")
}

dev.off()


FWS07SetDex<-c(1,2,7,18,19,21,22,23,24,27,34,36,37,38,42,43,44,51,
               52,53,56,57,64,69,88,93,100,102,104,106,108,124,133,
               140,144)

FWS07SetxLims<-data.frame()
FWS07SetxLims[1,c(1,2)]<-c(13510,13625)
FWS07SetxLims[2,c(1,2)]<-c(13510,13630)
FWS07SetxLims[3,c(1,2)]<-c(13510,13640)
FWS07SetxLims[4,c(1,2)]<-c(13510,13650)
FWS07SetxLims[5,c(1,2)]<-c(13510,13645)
FWS07SetxLims[6,c(1,2)]<-c(13510,13630)
FWS07SetxLims[7,c(1,2)]<-c(13510,13635)
FWS07SetxLims[8,c(1,2)]<-c(13510,13640)
FWS07SetxLims[9,c(1,2)]<-c(13510,13630)
FWS07SetxLims[10,c(1,2)]<-c(13510,13650)
FWS07SetxLims[11,c(1,2)]<-c(13510,13645)
FWS07SetxLims[12,c(1,2)]<-c(13510,13650)
FWS07SetxLims[13,c(1,2)]<-c(13510,13645)
FWS07SetxLims[14,c(1,2)]<-c(13510,13775)
FWS07SetxLims[15,c(1,2)]<-c(13510,13760)
FWS07SetxLims[16,c(1,2)]<-c(13510,13645)
FWS07SetxLims[17,c(1,2)]<-c(13510,13760)
FWS07SetxLims[18,c(1,2)]<-c(13510,13640)
FWS07SetxLims[19,c(1,2)]<-c(13510,13640)
FWS07SetxLims[20,c(1,2)]<-c(13510,13635)
FWS07SetxLims[21,c(1,2)]<-c(13510,13650)
FWS07SetxLims[22,c(1,2)]<-c(13510,13645)
FWS07SetxLims[23,c(1,2)]<-c(13510,13640)
FWS07SetxLims[24,c(1,2)]<-c(13510,13650)
FWS07SetxLims[25,c(1,2)]<-c(13510,13650)
FWS07SetxLims[26,c(1,2)]<-c(13510,13645)
FWS07SetxLims[27,c(1,2)]<-c(13510,13675)
FWS07SetxLims[28,c(1,2)]<-c(13510,13775)
FWS07SetxLims[29,c(1,2)]<-c(13510,13775)
FWS07SetxLims[30,c(1,2)]<-c(13675,13750)
FWS07SetxLims[31,c(1,2)]<-c(13675,13775)
FWS07SetxLims[32,c(1,2)]<-c(13510,13670)
FWS07SetxLims[33,c(1,2)]<-c(13510,13650)
FWS07SetxLims[34,c(1,2)]<-c(13510,13640)
FWS07SetxLims[35,c(1,2)]<-c(13510,13650)


PlotSet<-Pairs07[FWS07SetDex,]
RkmList<-unique(na.omit(RkmTable$RiverKm))
pdf(file = "/Users/nathanielcoombs/Documents/Git/Repos/FishTelPrac/Results/SingleRelease07SubSet.pdf")
for(i in 1:length(PlotSet[,1])){
  f1<-PlotSet[i,1]
  f2<-PlotSet[i,2]
  
  par(mfrow = c(2,2))
  

  plot(x = FWSSteelFall[which(FWSSteelFall$Fish == f1), "ChronTimes"],
       y = FWSSteelFall[which(FWSSteelFall$Fish == f1), "Rkm"],
       type = "l", xlab = "Date", ylab = "Rkm",
       main = paste("Waterfall plot for", f1, sep = " "))
  points(x = FWSSteelFall[which(FWSSteelFall$Fish == f1), "ChronTimes"],
         y = FWSSteelFall[which(FWSSteelFall$Fish == f1), "Rkm"],)
  abline(h = RkmList,col = gray(level = 0, alpha = .2))
  plot(x = FWSSteelFall[which(FWSSteelFall$Fish == f2), "ChronTimes"],
       y = FWSSteelFall[which(FWSSteelFall$Fish == f2), "Rkm"],
       type = "l", xlab = "Date", ylab = "Rkm",
       main = paste("Waterfall plot for", f2, sep = " "))
  points(x = FWSSteelFall[which(FWSSteelFall$Fish == f2), "ChronTimes"],
         y = FWSSteelFall[which(FWSSteelFall$Fish == f2), "Rkm"],)
  abline(h = RkmList,col = gray(level = 0, alpha = .2))
  FishDetMap(SHK200FWSDense,IDCol = "FishID", LatCol = "Lat", LonCol = "Lon", WaterMaps = CAHydroLL, 
             FishID = f1, LandMaps = CALandLL, textlab = TRUE, MonoCol = "Red", RkmCol = "FirstDet", StepDex = 7,
             nonNew = TRUE)
  FishDetMap(SHK200FWSDense,IDCol = "FishID", LatCol = "Lat", LonCol = "Lon", WaterMaps = CAHydroLL, 
             FishID = f2, LandMaps = CALandLL, textlab = TRUE, MonoCol = "Red", RkmCol = "FirstDet", StepDex = 7,
             nonNew = TRUE)
  
  par(mfrow = c(1,1))

  plot(x = FWSSteelFall[which(FWSSteelFall$Fish == f1), "ChronTimes"],
       y = FWSSteelFall[which(FWSSteelFall$Fish == f1), "Rkm"], ylim = c(0, 525),
       type = "l", xlab = "Date", ylab = "Rkm", col = "Red", xlim = c(FWS07SetxLims[i,1],FWS07SetxLims[i,2]),
       main = paste("Waterfall plot for", f1, f2, sep = " "))
  points(x = FWSSteelFall[which(FWSSteelFall$Fish == f1), "ChronTimes"],
         y = FWSSteelFall[which(FWSSteelFall$Fish == f1), "Rkm"], col = "Red")
  lines(x = FWSSteelFall[which(FWSSteelFall$Fish == f2), "ChronTimes"],
        y = FWSSteelFall[which(FWSSteelFall$Fish == f2), "Rkm"], col = "Blue")
  points(x = FWSSteelFall[which(FWSSteelFall$Fish == f2), "ChronTimes"],
        y = FWSSteelFall[which(FWSSteelFall$Fish == f2), "Rkm"], col = "Blue")
  abline(h = RkmList,col = gray(level = 0, alpha = .2))
}

dev.off()
f1 <- "STH0464"
f2 <- "STH0467"

plot(x = FWSSteelFall[which(FWSSteelFall$Fish == f1), "ChronTimes"],
     y = FWSSteelFall[which(FWSSteelFall$Fish == f1), "Rkm"], ylim = c(0, 525),
     type = "l", xlab = "Date", ylab = "Rkm", col = "Red", xlim = c(13630,13640),
     main = paste("Waterfall plot for", f1, f2, sep = " "))
points(x = FWSSteelFall[which(FWSSteelFall$Fish == f1), "ChronTimes"],
       y = FWSSteelFall[which(FWSSteelFall$Fish == f1), "Rkm"], col = "Red")
lines(x = FWSSteelFall[which(FWSSteelFall$Fish == f2), "ChronTimes"],
      y = FWSSteelFall[which(FWSSteelFall$Fish == f2), "Rkm"], col = "Blue")
points(x = FWSSteelFall[which(FWSSteelFall$Fish == f2), "ChronTimes"],
       y = FWSSteelFall[which(FWSSteelFall$Fish == f2), "Rkm"], col = "Blue")
abline(h = PerfectSites,col = gray(level = 0, alpha = .2))

# Time to try working with DetReducer
PlotSet<-Pairs07[FWS07SetDex,]
RkmList<-unique(na.omit(RkmTable$RiverKm))
PlotDispLCSSet<-list()
FWS07_200Dense$FirstDet<-as.chron(FWS07_200Dense$FirstDet)
FWS07_200Dense$LastDet<-as.chron(FWS07_200Dense$LastDet)
for(i in 1:length(PlotSet)){
  PlotDispLCSSet[[i]]<-DetReducer(DenseFrame = FWS07_200Dense, FishSet = PlotSet[i,], fCol = "FishID", 
                                  t1Col = "FirstDet", t2Col = "LastDet",SiteCol = "Loc")
  
}

PlotDispLCSSet[[1]]<-DetReducer(DenseFrame = FWS07_200Dense, FishSet = PlotSet[1,], fCol = "FishID", 
           t1Col = "FirstDet", t2Col = "LastDet",SiteCol = "Loc")


LCSDemo1<-DetReducer(DenseFrame = FWS07_200Dense, FishSet = c("STH0452","STH0461"), fCol = "FishID", 
                     t1Col = "FirstDet", t2Col = "LastDet",SiteCol = "Loc")



pdf(file = "/Users/nathanielcoombs/Documents/Git/Repos/FishTelPrac/Results/DISPSingleRelease07Set.pdf",paper = "USr")

dev.off()





